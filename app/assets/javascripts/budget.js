// Generated by CoffeeScript 1.9.3
(function() {
  var BudgetPlugin;

  BudgetPlugin = (function() {
    function BudgetPlugin() {
      jQuery((function(_this) {
        return function() {
          _this._init_budget_calculator();
          return _this._init_time_calculator();
        };
      })(this));
      true;
    }

    BudgetPlugin.prototype._init_budget_calculator = function() {
      var _cost_per_hour, _rate, _rate_acc_cost, _rate_base_cost, _rate_overhead, _root;
      _root = $('.redmine_budget');
      if (_root.length === 0) {
        return;
      }
      _cost_per_hour = parseFloat($('[name=cost_per_hour]', _root).val());
      _rate = _cost_per_hour + (_cost_per_hour * 0.8) + (_cost_per_hour * 0.33);
      _rate = Math.ceil(_rate + (_rate * 0.5));
      $('[name=rate]', _root).val(_rate);
      _rate_base_cost = _rate * 0.313;
      _rate_overhead = _rate * 0.2504;
      _rate_acc_cost = _rate * 0.1033;
      $('[name=budget]', _root).val(160);
      $('[name=burned]', _root).val(1);
      $('[name=budget],[name=burned]', _root).on('change', function() {
        var _acc_cost, _budget, _burned, _cost, _overhead;
        _budget = parseFloat($('[name=budget]', _root).val());
        _burned = parseFloat($('[name=burned]', _root).val());
        $('[name=available]', _root).val(_budget / _rate);
        $('[name=cost]', _root).val(_cost = _burned * _rate_base_cost);
        $('[name=overhead]', _root).val(_overhead = _burned * _rate_overhead);
        $('[name=acc_cost]', _root).val(_acc_cost = _burned * _rate_acc_cost);
        return $('[name=profit]', _root).val(_budget - (_cost + _overhead + _acc_cost));
      });
      return $('[name=budget]', _root).trigger('change');
    };

    BudgetPlugin.prototype._init_time_calculator = function() {
      var _root;
      _root = $('form.time_calculator');
      if (_root.length === 0) {
        return;
      }
      return $('[name=hours]', _root).val("test");
    };

    return BudgetPlugin;

  })();

  window.BudgetPlugin = new BudgetPlugin();

}).call(this);
